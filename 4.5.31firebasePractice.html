<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>
</html>
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>파이어베이스 연습</title>
  </head>
  <style>
    tr {
      cursor: pointer;
      height: 50px;
    }
    .selected {
      background-color: yellow;
    }
  </style>
  <body>
    <p>
      <label>이름 :</labe>
      <input type ="text" name="name" />
    </p>
    <p>
      <p>
        <label> 나이 :</labe>
        <input type ="text" name="name" />
      </p>
      <p>
        <p>
          <label> 이메일 :</labe>
          <input type ="text" name="name" />
        </p>
        <p>
          <p>
            <label> 전화번호 :</labe>
            <input type ="text" name="name" />
          </p>
          <p>
            <p>
              <label> 성별 :</labe>
              <input type ="text" name="name" />
            </p>
            <button id="saveBtn">데이터저장</button>
                          
    <table border= "1">
      <tr>
        <th>이름</th>
        <th>나이</th>
        <th>성별</th>
        <th>이메일</th>
        <th>전화번호</th>
      </tr>
    </table>
    <br><br>
    <button id="updateBtn">회원정보수정</button>
    <button id="saveUpdateBtn">회원정보저장</button>
    <button id="deleteBtn">회원삭제</button>
  </body>
  <script type="module">
    import { db, getMembers,  } from "/resources/js/firebase.js";
    async function getMembers () {

    }
 //   const snapshot = await getMembers("member");
 //   const tableTag = document.querySelector("table");
 //   let tagStr = ""; 
 //   snapshot.forEach((doc) => {
 //     const { name, age, gender, tel, email } = doc.data();
   //   tableTag.insertAdjacentHTML(
   //     "beforeend",
        `
    //        <tr>
   //             <td>${name}</td>
    //            <td>${age}</td>
     //           <td>${gender}</td>
     //           <td>${email}</td>
    //            <td>${tel}</td>
    //        </tr>
    <input type = 'hidden' value='' />
    ;
        `
   //   );
   // });
tableTag.innerHTML = tagStr;
console.log("getMembers 함수 종료");
//  }

  // 맴버 조회 및 이벤트 핸들러 등록하는 함수
function getMembersHandleTrClick() {
getMembers(). then(handleTrClick);
}


// tr 태그에 click 이벤트 적용
    getMembers().tneh(handleTrclick);
   // handleTrClick();

// tr태그에 click 이벤트 적용
function handleTrClick() {
  console.log("handTrclick 이벤트 시작")
  // tr 태그에 click 이벤트 적용
  const trs = document.querySelectorAll("tr");
  trs. forEach(tr => {
tr. addeEventListener("click, (e) => {
tr.classList.toggle('selected');
 });
});

const = document.getElementBId("deleteBtn")
deleteBtn.addEventListener("click", function() {
const selectedTrs = document. querySelectorAll("tr.selected");
});

const updateBtn = document.getElenebtById("updateBtn")
updateBtn.addEventListener("click", function() {
    const selectedTrs = document.querySelectorAll("tr.selector")
    if(selectedTrs.length == 0) {
        alert("수정할 회원을 선택해주세요.");
        return false;
    }else if(selectedTrs.length >= 2) {
alert("회원정보 수정은 하나씩만 가능합니다.");
return false;
   }

const selectedTr = selectedTrs[0];
const trChlidren = selectedTr.children;
console.log(trChildren);
  for(let i = 0; i < trChildren. length; i++) {
    trChildren[i].addEventListrener(e)) => {
e.stopPropagation();
    });
const tdText = trChildren[i].innerText;
trChildren[i]. innerHTML = '<input type = 'text' value ='${tdText}' />' ;'
  }

//<tr>
 //   <td>테스트</td>
  //  <td>테스트</td>
  //  <td>테스트</td> 
  //  <td>테스트</td>
  //  <td>테스트</td>
  //  <td>010-1111-2222</td>
  //  </tr>
  // selectedTrs[0]
  
  const saveUpdateBtn = document.getElementById("saveUpdate")
  saveUpdateBtn. addEventListener("click, function() {
const selectedTr= document.querySelctor("tr.selected");

const selectedTr = document.querySelector('tr.select')
const trChildren= selectedTr. children;
for(let i = 0; i < trChildren.lengthl i++) {
    if(trChildren.tagNmae ! = "INPUT") {
        trChildren[i]. innerHtmL = '${trChildren.firstElementChild.value}';
    }
}
});
   
trChildren[i].innerHTML = '${trChildren[i].firstElementChild.value}';

}
})

const btn =document.getElementById("saveBtn");
    btn.addEventListener("click", async function() {
      // const forml = document.querySelector("form[name='jo']")
      const formEI -document.forms[0];
      const formElChildren = formEI. elements;
      const formElChildrenArr = [...formELChildren];
      const joinFormObj = {};
      formElChildrenArr. forEach(input => {
joinFormObj.[input.name] = input.value;
     // });
     
     const saveUpdateBtn = document.getElementById('saveUpdateBtn');
     saveUpdateBtn.addEventListener('click', function () {
        const selectedTr =document. querySelector('tr.selecte')
        const trChildren = selectedTr.querySelectorAll(' tr >*');

        // 수정된 내용을 화면에 반영한다.

        // DB의 데이터를 수정할 정보를 추출한다.

        // HTMLCollection 을 배열로 만들어준다.
        const trChildrenArr =Array.from();
        // input 요소(가장 마지막)를 따로 꺼낸다.
        const docIdInput = trChildrenArr.pop().value;
        const updateObj =trChilderenAr..reduce((acc. cur)) =>
      //  <td class="name">홍길동</td>
        <td class="age"
      //  console.log(docId);
     });


       // console.log(trChildrenArr);
        let originTrStr = "";
       // for (let i = 0l i < trChildren.lengthl i++) {
          //  if (trChildren[i]).firstElementChild.value}</td>';'
        const originTrStr = "";
      //  trChildren.forEach(child => {

        })
    //});
     //   console.log(TrChildren);
    // console.log(joinFormObj);
     
     // console. log(foreElChildreArr);
//formElChildren.name. cur value
      retirm { ...ac, [cur,name]: cur. value} ;
//FormObj = formElchilderenArr.reduce((acc, cur) => {

}
//FormObj (joinFormObj);
      
      const memberInfo = {
name: document.querySelector("input[name= 'name']"). value,
age: Number(document.querySelector("input[name= 'age']"). value,
tel: document.querySelector("input[name= 'tel']"). value,
genderemail: document.querySelector("input[name= 'gender']"). value,
email: document.querySelector("input[name='email']").value,
};
console. log(memberInfo);
// 파이어베이스에 데이터를 저장
updateDates  
const result = await addDates('menber', memberInfo);
addDatas("member", memberInfo);
// 저장 결과가 성공 ==> 페이지 리로딩
// 결과가 실패 ==> 저장을 실패했습니다." alert
result ? getMembersHandleTrClick() : alert;('저장을 실패했습니다');
  //  });


    // 문서 ID 가져오기
    selectedTrs. forEach (tr => {
const docId = tr. lastElemenChild.value;
deleteDatas.log("member", docId)
    });
    .then (getMembers);
// });
  


let value;

    try {
// value = zero;
value = 0;
    } catch (error) {
      console.log(error);
    } 
    value =zero;

    
  </script>
</html>
